<ARTICLE ID="Article_1">
<HEADER ID="Header_Article_1">
<H2>Building IoT Projects</H2>
</HEADER>
 
<SECTION ID="Section_1">
 <H3>Week 1 - Group Members Github account</H3>
	<a href="https://KenVit.github.io">Kenneth</a>
	<br>
	<a href="https://Jonnytlv.github.io">Jonny</a>
 </SECTION>
 
<SECTION ID="Section_2">
<H3>Week 2 - Project Proposal </H3>
</SECTION>	

<SECTION ID="Section_3">
<H3>Week 3 - Gantt Chart</H3>
	<a href ="fntj0052.github.io/OneTapShots.mpp">OneTapShots.mpp</a>
</SECTION>
	
<SECTION ID="Section_4">
<H3>Week 4 - Budget Plan</H3>
	<a href="fntj0052.github.io/Budget.docx">Budget.docx</a>
</SECTION>
	
<SECTION ID="Section_5">
<H3>Week 5 - Proof of purchase</H3>
 <p>Receipt Copy</p>
 <img src="Capture.PNG" alt="Capture Icon" style="width:508px;height:440px;">
 <img src="Capture2.PNG" alt="Captur2 Icon" style="width:508px;height:440px;">
	<p>The reciept copy pictures are for all the team members in the group. We bought the hardware together as one order</p>
</SECTION>

<SECTION ID="Section_6">
<H3>Week 6 - Mechanical Assembly milestone</H3>
	<a href="fntj0052.github.io/ProgressReport2.docx">ProgressReport.docx</a>
</SECTION>

<SECTION ID="Section_7">
<H3>Week 7 - Power-up milestone</H3>
</SECTION>

<SECTION ID="Section_8">
<H3>Week 8 - Placard</H3>
	<p>The group placard is in KenVit.github.io</p>
	<a href="https://KenVit.github.io">Placard-refference</a>
</SECTION>

<SECTION ID="Section_9">
<H3>Week 9 - Video Report</H3>
</SECTION>

<SECTION ID="Section_10">
<H3>Week 10 - Progress Report</H3>
	<a href="fntj0052.github.io/Hardware Assembly Progress Report 3.docx">ProgressReport3.docx</a>
</SECTION>
	
<SECTION ID="Section_11">
<H3>Week 11 - Progress Report</H3>
</SECTION>

<SECTION ID="Section_13">
<H3>Week 13 - Presentation</H3>
	<a href="fntj0052.github.io/One Tap Shots-Presentaion.pptx">Presentation</a>
</SECTION>

<ARTICLE ID="Article_1">
<HEADER ID="Header_Article_1">
  <H2>One Tap Shots</H2>
</HEADER>
	<SECTION ID ="Section_14">
<H2>Week14</H2>
	<p><b><H3>Introduction</H3></b><br>
		This project's goal is too mix and dispense drink into a glass. So our project is able to ouput user's choice of
		drink mixture by using a LCD screen with a touch sensor which automatically mix and dispense drink when the user
		press or tap the selection from the database. Also it detects the level of liquid using a water sensor that will 
		send an e-mail alert to the user if the liquid is low and needed a refill.
	
	</p>
	<p><b><H3>System Diagram</H3></b><br>
	</p>
		<p><img src="fntj0052.github.io/Diagram.PNG" alt="Capture3 Icon" style="width:508px;height:440px;"></p>
<p><b><H3>Bills of Material / Budget</H3></b><br>
	<table>
			<tbody>
				<tr>
				<th>Equipement</th>
				<th>Quantity</th>
				<th>Cost with tax</th>
				</tr>
				
				<tr>
				<td>Raspberry Pi 3 CanaKit</td>
				<td>1</td>
				<td align ="right">$50</td>
				</tr>
				
				<tr>
				<td>Pi Micro SD</td>
				<td>1</td>
				<td align ="right">$19.99</td>
				</tr>
				
				<tr>
				<td>5V Adapter</td>
				<td>2</td>
				<td align ="right">$12.99</td>
				</tr>
				
				<tr>
				<td>LCD Screen</td>
				<td>1</td>
				<td align ="right">$75</td>
				</tr>
				
				<tr>
				<td>2xWater Pump</td>
				<td>1 </td>
				<td align ="right">$50</td>
				</tr>
				
				<tr>
				<td>Touch Sensor</td>
				<td>1 </td>
				<td align ="right">$7</td>
				</tr>
				
				<tr>
				<td>Water Sensor</td>
				<td>1 </td>
				<td align ="right">$8</td>
				</tr>
				
				<tr>
				<td>Total</td>
				<td> </td>
				<td align ="right">$222(tax not inculded)</td>
				</tr>
			</tbody>
		</table>
		<p><i>Table 1: Required time for building the project.</i></p>	
	<p><b><H3>Time Commitment</H3></b><br>
		<p><i>Table 1: budget of the project</i></p>	
	<p><b><H4>Time Commitment</H4></b><br>
		You will spend this amount of time finishing this project by this build guide.
			<table>
			<tbody>
			<tr>
			<th>Tasks</th>
			<th>Time Required</th>
			</tr>
				
			<tr>	
			<td>Raspberry Pi 3B: install the OS and connect it to the internet</td>
			<td align ="right">30 mins</td>
			</tr>
				
			<tr>
			<td>PCB Soldering: Printing PCB takes around 1 hour soldering and testing could take around 4 hours</td>
			<td align ="right">5 hours</td>
			</tr>
				
			<tr>
			<td>Project Wiring, connect sensors, leds to raspberry pi</td>
			<td align ="right">1 hour +</td>
			</tr>
				
			<tr>
			<td>Importing python code</td>
			<td align ="right">15 mins</td>
			</tr>
			
			<tr>
			<td>Running code with your hardware connected</td>
			<td align ="right">5 mins</td>
			</tr>
			
			<tr>
			<td>Unit testing for unexpected error</td>
			<td align ="right">1 hour</td>
			</tr>
			
				
			<tr>
			<th>Total Time Commitment</th>
			<th align ="right">7 hr 50 mins</th>
			</tr>
		</tbody>
		</table>
	<p><i>Table 2: Required time for building the project.</i></p>		
 
<p><b><H3>Mechanical Assembly</H3></b><br></p>
	<p>This shows the circuit build for the touch sensor and water sensor </p>
	<p><img src="fntj0052.github.io/circuit.JPG" alt="Capture4 Icon" style="width:508px;height:440px;"></p>
	
	<p><b><H3>PCB/Soldering</H3></b><br>
		<p>implementing Water-Pump-PCB to the build didn't work. </p>
	
	<p><b><H3>Unit Testing</H3></b><br>
		<p>You can use these programs for testing Touch Screen Sensor and Water Pump Sensor.</p>
		
	<p><b> touchSensor.py </b><br> 
	<code><pre>
	import time
	import RPi.GPIO as GPIO
	GPIO.setmode(GPIO.BCM)
		
	padPin = 23
	GPIO.setup(padPin, GPIO.IN)
	alreadyPressed = False
	while True:
	padPressed = GPIO.input(padPin)
	if padPressed and not alreadyPressed:
	print "pressed"
		
	alreadyPressed = padPressed
	time.sleep(0.1)
	</pre>
	</code>
		
	</p>
		
	<p><b> waterPumpSensor.py </b><br> 
	<code><pre>
	########################################
	#  Login credentials to send email#
	########################################

	username = 'jv2ee@yahoo.com'
	password = 'EmailPassword'

	############################
	# General Email Parameters #
	############################ 

	From = "jv2ee@yahoo.com"
	To =  "jv2ee@yahoo.com"

	#######################################
	# Email Parameters when sensor is Wet #
	#######################################

	Subject_wet = "RPi Water Sensor is WET"
	Body_wet = "Your water sensor is wet."

	#######################################
	# Email Parameters when semsor is Dry #
	#######################################

	Subject_dry = "RPi Water Sensor is DRY"
	Body_dry = " Your water sensor is dry again!"

	import smtplib
	from email.mime.text import MIMEText
	import RPi.GPIO as GPIO
	import string
	import time

	#Function Definitions

	#takes either "wet" or "dry" as the condition.
	def email(condition):
    	print "Attempting to send email"
    	if condition == 'wet':
        Body = string.join((
        "From: %s" % From,
        "To: %s" % To,
        "Subject: %s" % Subject_wet,
        "",
       	Body_wet,
	 ), "\r\n")
    	if condition == 'dry':        
       	Body = string.join((
        "From: %s" % From,
        "To: %s" % To,
        "Subject: %s" % Subject_dry,
        "",
        Body_dry,
        ), "\r\n")
        
	# The actual mail send
        server = smtplib.SMTP('smtp.gmail.com:587')
        server.starttls()
        print "Logging in..."
        server.login(username,password)
        print "Logged in as "+username+"."
        server.sendmail(From, [To], Body)
        server.quit()
        print "Email sent."

	#Tests whether wter is present.
	# returns 0 for dry
	# returns 1 for wet
	# tested to work on pin 18 
	def RCtime (RCpin):
    	reading = 0
    	GPIO.setmode(GPIO.BCM)
    	GPIO.setup(RCpin, GPIO.OUT)
    	GPIO.output(RCpin, GPIO.LOW)
    	time.sleep(0.1) 
    	GPIO.setup(RCpin, GPIO.IN)
    	# This takes about 1 millisecond per loop cycle
    	while True:
        if (GPIO.input(RCpin) == GPIO.LOW):
            reading += 1
        if reading >= 1000:
            return 0
        if (GPIO.input(RCpin) != GPIO.LOW):
            return 1


	def buzz_on (pin):

    	GPIO.setmode(GPIO.BCM)
    	GPIO.setup(pin, GPIO.OUT)
    	GPIO.output(pin, GPIO.HIGH)

	def buzz_off(pin):

    	GPIO.setmode(GPIO.BCM)
    	GPIO.setup(pin, GPIO.OUT)
    	GPIO.output(pin, GPIO.LOW)

	# Main Loop

	print 'Waiting for wetness...'
	while True:
   	time.sleep(1)
    	if RCtime(18) == 1:
        print "Sensor is wet"
        email('wet')
        while True:
            time.sleep(1)
            if RCtime(18) == 1:
                print "Sensor is still wet..."
                buzz_on(17)
                continue
            if RCtime(18) == 0:
                buzz_off(17)
                print "Sensor is dry again"
                email('dry')
                print "Waiting for wetness..."
                break
		
		</pre>
		</code>
		
		</p>
		
		<p> These are the folllowing files that we used.
		<br><a href="fntj0052.github.io/touchsensor.py">touchsensor.py</a>
		<br><a href="fntj0052.github.io/waterpumpsensor.py">waterpumpsensor.py</a></p>

		
		<p><b><H3>Production Testing</H3></b><br>
		<p>Motor Movement Fucntion (Motor will be included next semester)</p>
		
		<p>Main program  <br><h4>pumpForward.py</h4><br>
			<code><pre>
	import sys
	import time
	import RPi.GPIO as GPIO


	mode=GPIO.getmode()
	print " mode ="+str(mode)


	StepPinForward=32
	StepPinBackward=36

	GPIO.setmode(GPIO.BOARD)
	GPIO.setup(StepPinForward, GPIO.OUT)
	GPIO.setup(StepPinBackward, GPIO.OUT)

	def forward(x):
    	GPIO.output(StepPinForward, GPIO.HIGH)
    	print "forwarding running pump"
    	time.sleep(10)
    	GPIO.output(StepPinForward, GPIO.LOW)


	print "forward pump"
	forward(5)

	print "Stopping motor"
	GPIO.cleanup()
			</pre>
			</code>
	
		
	
	<p>Main program  <br><h4>pumpBack.py</h4><br>
			<code><pre>
	import sys
	import time
	import RPi.GPIO as GPIO

	mode=GPIO.getmode()
	print " mode ="+str(mode)
	GPIO.cleanup()


	StepPinForward=32
	StepPinBackward=36

	GPIO.setmode(GPIO.BOARD)
	GPIO.setup(StepPinForward, GPIO.OUT)
	GPIO.setup(StepPinBackward, GPIO.OUT)

	def forward(x):
    	GPIO.output(StepPinBackward, GPIO.HIGH)
    	print "backward running pump"
    	time.sleep(10)
    	GPIO.output(StepPinBackward, GPIO.LOW)


	print "backward pump"
	forward(5)

	print "Stopping motor"
	GPIO.cleanup()

			</pre>
			</code>
		
	<p>These are the files used:
	<br><a href="fntj0052.github.io/pumpForward.py">pumpForward.py</a>
	<br><a href="fntj0052.github.io/pumpBack.py">pumpBack.py</a>
			
	<p><b><H3>Build Video</H3></b><br>
	<p></p>
	<video controls>
		<source src="fntj0052.github.io/BuildVideo2.mp4" type="video/mp4">
		Your browser does not support the video tag.
		</video>
	
	<p><b><H3>Reproducibility Based on Instructions</H3></b><br>
		
	<p>Currently,it is possible to reproduce the project by following the codes and the circuit diagram. </p>
	
		
</SECTION>
	
<SECTION ID="Section_0">
<H3>Future Lab Weeks</H3>
	<p>Week 12 - Progress Report Due</p>
	<p>Week 13 - Presentation Due</p>
	<p>Week 14 - Build Instruction Due</p>
	<p>Week 15 - 30 Second Script Due</p>
</SECTION>
	


</ARTICLE>
